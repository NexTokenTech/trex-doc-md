An accurate and robust system time is essential to timed-release encryption in our decentralized network. Other time-puzzle locks or verifiable delay functions can be sped up or slowed down with different CPU clock speeds. However, without external reference, a single computer cannot sense the elapsed time. The typical centralized backend service can query current network time with [network time protocol](https://en.wikipedia.org/wiki/Network_Time_Protocol) from a trusted time source. However, network time protocol is prone to [man-in-the-middle attacks](https://en.wikipedia.org/wiki/Man-in-the-middle_attack) even if we assume the network time service is trustworthy.

# Network time security
Our current solution is adopting [network time security protocol](https://www.rfc-editor.org/rfc/rfc8915.html) into the TEE. This new protocol prevents the keyholder from man-in-the-middle attacks and ensures secured communication between the TEE and network time servers. Furthermore, to avoid a single point of failure, the keyholder will request network times from a federation of multiple trusted time sources and eliminate outliers. For NTS protocol, please use [this whitepaper](https://www.netnod.se/time-and-frequency/white-paper-how-does-nts-work-and-why-is-it-important) as a reference. For implementation details, use this [GitHub link](https://github.com/NexTokenTech/trex-keyholder/tree/main/enclave-runtime/src/nts_protocol)

# Time reference borrowing
Our next-generation keyholder code will host a light blockchain client inside the TEE and verify the [block time](https://en.wikipedia.org/wiki/Blockchain#Block_time) from dominant global blockchain networks (e. g. Bitcoin, Ethereum, Solana, and Polkadot). The blockchain serves as a large-scale decentralized clock since each block contains a timestamp verified by an extensive network. That way, the keyholder node can "borrow" a global time reference from an established blockchain network to determine the release of the key pieces. It would be our final solution to achieve complete decentralization.

